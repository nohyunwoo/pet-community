events {}

http {
    server {
        listen 80;

        # 파비콘 직접 서빙 (배포 서버와 동일한 로직 테스트)
        location = /favicon.ico {
            root /usr/share/nginx/html;
            access_log off;
            log_not_found off;
        }

        # 정적 파일 캐싱 (배포 서버와 동일)
        location ~ ^/(css|images|js)/ {
            # host.docker.internal이 내 PC의 8080(IDE)을 가리킵니다.
            proxy_pass http://host.docker.internal:8080;
            expires 30d;
        }

        # 나머지 모든 요청을 IDE에서 실행 중인 앱으로 전달
        location / {
            proxy_pass http://host.docker.internal:8080;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
}